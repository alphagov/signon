<%= form_tag action, method: :patch do |f| %>
  <div data-module="accessible-autocomplete">
    <%= render "govuk_publishing_components/components/select", {
      id: "new_permission_id",
      heading_size: "m",
      hint: "Search for the permission you want to add.",
      label: "Add a permission",
      name: "application[new_permission_id]",
      options: unassigned_permission_options.unshift({ text: '', value: nil })
    } %>
  </div>

  <% assigned_permissions.map(&:id).each do |id| %>
    <%= hidden_field_tag "application[current_permission_ids][]", id %>
  <% end %>

  <%= hidden_field_tag "application[add_more]", "false" %>

  <div class="govuk-button-group">
    <%= render "govuk_publishing_components/components/button", {
        text: "Add",
        aria_label: "Add permission",
        classes: "js-autocomplete__add-button"
    } %>

    <%= render "govuk_publishing_components/components/button", {
        text: "Add and finish",
        aria_label: "Add permission and finish",
        classes: "js-autocomplete__add-and-finish-button"
    } %>

    <%= render "govuk_publishing_components/components/button", {
        text: "Clear selection",
        type: "button",
        classes: "js-autocomplete__clear-button",
        secondary_solid: true
    } %>
  </div>
<% end %>
